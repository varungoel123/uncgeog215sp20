<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Reproducible Research</title>
    <meta charset="utf-8" />
    <meta name="author" content="Intro To Spatial Data Science" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <script src="https://use.fontawesome.com/5235085b15.js"></script>
    <link rel="stylesheet" href="css/my-theme_nologo.css" type="text/css" />
    <link rel="stylesheet" href="css/my-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Reproducible Research
## Class #13 | GEOG 215
### Intro To Spatial Data Science

---





---
# Today's Class

### Reproducible Research
  - #### Motivation
  - #### What is it?
  - #### Why is it important?
  - #### How to do it?

### Midterm logistics

---
### Reality of Scholarly Communication
&lt;img src="img/scholarly_communication.jpeg" width="50%" style="display: block; margin: auto;" /&gt;

---
# Scholarly communication

#### Traditional modes of communication of analytical results are:

  - Manuscripts
  - Reports
  - Presentations
  - Posters
  - Websites
  - Dashboards

---

# Purpose of scholarly communication

  - #### To report what you’ve **actually** discovered, **clearly enough** that **someone else can discover it for themselves**.
  
    - #### To make it easier for readers to understand what you did
  
    - #### ***To make it easier for readers to replicate/reproduce what you did***

---

# However....

#### Modern statistical software = "blackbox"

--

### Readers are supposed to focus on the final results

  - *and not the code that derived it*
  
---
class:middle, inverse, center

&gt; # Should I even care about the code?

---
class:middle, inverse, center

&gt; # YESSSSSSSSS!!! YOU SHOULD 

---
class:middle, inverse, center

&gt; # I AM SERIOUS!!! YOU SHOULD

---
### Reproducibility crisis in science

#### Intentional mistakes
&lt;img src="img/duke_scandal1.png" width="40%" style="display: block; margin: auto;" /&gt;&lt;img src="img/duke_scandal2.png" width="40%" style="display: block; margin: auto;" /&gt;

---
### Reproducibility crisis in science

#### Unintentional mistakes

&lt;img src="img/error1.png" width="60%" style="display: block; margin: auto;" /&gt;

---
### Influence on the public

&lt;img src="img/this_american_life.png" width="80%" style="display: block; margin: auto;" /&gt;

---
### Researchers (including you and me) are fallible too

&lt;img src="img/bias_reproducibility.jpeg" width="50%" style="display: block; margin: auto;" /&gt;

---
# Reproducible Research

- #### Original data and (computer code) can be re-analyzed by an independent investigator to obtain the same results

  - #### The analysis can be successfully repeated
  
  - #### Highly important in studies where computational analysis plays a large role

---
# Reproducible Research

- #### Expose more of the research workfow to our audience

  - Easier for them to make a more informed assessment of our methods and results
  
  - Easier for them to adapt our methods to their own research

---
# Reproducible Research

&lt;img src="img/reproducibility_spectrum.jpg" width="70%" style="display: block; margin: auto;" /&gt;

---
# Reproducible Research

- Science moves forward when discoveries are **replicated** and **reproduced**

  - Many important scientific advancements have been incremental
  
  - Verifiability and reproducibility are among the cornerstones of the scientific process. 
  
  - They allow scientists to **"stand on the shoulder of giants".**
  
  - incremental + incremental + incremental .... ..... + incremental = *"Nobel Prize"*

---
### Replicable vs Reproducible

#### Replicable Research

  - If you *collected new data* and *performed the experiment again* or *answered the same question*, would you receive consistent results?
  
  - independent investigators use methods, protocols, data, and equipment to confirm scientific claims.
  
  - Often expensive, and tough to do as new settings can induce errors or differences
  
  - Replicable research is reproducible
---
### Replicable vs Reproducible Vs Correct Research

#### Reproducible Research

  - when data sets and computer code are made available for researchers to verify results
  
  - If you ran analysis on the same data using the same set of methods that the researcher specified, would you receive same results?
  
  - A study is reproducible if there is a specific set of computational functions/analyses (usually specified in terms of code) that exactly reproduce all of the numbers in a *published* paper from *raw* data
  
  - *Reproducible* is not necessarily *replicable*
  
  - *Reproducible/replicable* is not necessarily *correct*
  
    - The study could be poorly designed or executed but still be reproducible or replicable

---
# Why should I care?

- Avoid embarrassment

- Save time, in the long run

- Improves your mental health ! ! ! (ask me)

-  Show evidence of correctness
  - Allows for independent evaluation
  
- Greater potential for extension impact for your work
  - Others can build on your work/methods
  - You can build on your prior work

---
class:middle, inverse, center

&gt; ### Your closest collaborator is you six months ago,
but you don't reply to emails.

---
# What could go wrong?

- "The attached is similar to the code we used."
- "Where did this data file come from?!"
- "Can you repeat the analysis, omitting subject X?"
- "This part of your script is now giving an error."

---
class: middle, inverse, center

### How to perform do reproducible research?

---
class: middle, inverse, center

### Good News!

--

### You already doing some of it

---
# Bad News

  - Importance is widely recognized, but not widely practiced

--

  - More start up time

--  

  - Not sent up for instant gratificiation

--

  - Takes a different mindset (Challenges our biases and in some cases, EGO!)

--
### However
- Will be outweighed by time saved later
- You can go back in time and fix errors with confidence
- Becomes easier with practice

---
# Basic Principles

  - Everything via code
  - Everything automated
  - Workflow and dependencies clearly documented
  - Get the data in the most-raw form possible
  - Get any/all data and meta-data possible
  - Keep track of the provenance of all data files
  - *Be self-sufficient

---
### Four facets of reproducibility

  - *Documentation*
    - Use markdown to document your workflow so that anyone can pick up your data and follow what you are doing
    - Use *literate programming* so that your analysis and your results are tightly connected, or better yet, unseperable

  - *Organization*
    - tools to organize your projects so that you don't have a single folder with hundreds of files

  - *Automation*
    - the power of scripting to create automated data analyses

  - *Dissemination*
    - publishing is not the end of your analysis, but paves way for future research.

---
class:middle, inverse, center

&gt; ## YOU ARE ALREADY DOING ALL OF THIS

---
# Is this reproducible ?

- Open a an excile file to extract as CSV

--

- Open a csv file in word and delete first blank row

--

- Save your graph from R on your desktop and paste it in your markdown file

--

- Manually type in numbers/results in your Rmarkdown Document


--

- Submit your final project in word, and Paste results into the text 

---

## In future labs/assignments

- We will practice and assess how reproducible our analysis is

---
class:middle, inverse, center

&gt; ### MID-TERMS LOGISTICS

---
# Midterm Exam Structure

- 15% of your grade
- Timed exam on Sakai
- Multiple choice, True and False, fill in the blanks, short answers
- Focus on both theory and programming skills
- Covers all material till (including) today.
- Lectures, labs, readings, data camp
- Distributed Thursday morning
- Take exam by March 4, 11:59 pm.
- You can study together, but no collaboration while taking exam
- Piazza will be paused during exam time

---
# Your resources

- Class materials (lectures, labs, readings, piazza, data camp)

- Your TA, me (for clarifying questions)

- Practice Questions (w answers)
  - We will go through some in class on Wednesday and some for you to practice on your own
  
- Wednesday's class
  - Send me any doubts you have about course material that you would like to be discussed by tomorrow night
  
---
# Examples

# Answer Qs based on screenshots:

&lt;img src="img/screenshot1.png" width="50%" style="display: block; margin: auto;" /&gt;

- How many attributes, and features are there?
- Is this a projected system ? True of False
- What does each observation represent?

---
# Answer Qs based on code:


```r
colnames(nc_wide)
```

```
 [1] "geoid"            "name"             "white"            "black"           
 [5] "native_americans" "hispanic"         "poc"              "white_majority"  
 [9] "total_population" "med_hh_income"   
```

```r
newdat &lt;- nc_wide %&gt;% select(geoid:black, ends_with("n"))
```

#### Based on this code: what will be the dimensions of newdat ?

---
# Output type 1


```r
x &lt;- c(1:6,5,NA,NA,10,5)
which(x &gt;=5)
```

What will be the output?

  a. An error
  
  b. logical vector with 7 elements
  
  c. logical vector with 11 elements
  
  d. NA
  
  e. numerical vector with 7 elements
  
  f.numerical vector with 5 elements

---

---
# Output type 2


```r
x &lt;- c(1:6,5,NA,NA,10,5)
which(x &gt;=5)
```

What will be the output?

a. An error

b. FALSE TRUE NA NA TRUE TRUE

c. 5 6 7 10 11

d. 5 6 7 NA NA 10 11

e. 2 3 NA NA 6 7

f. 2 3 6 7

---
# Fill in the blanks: Type 1

```r
colnames(nc_wide)
```

```
 [1] "geoid"            "name"             "white"            "black"           
 [5] "native_americans" "hispanic"         "poc"              "white_majority"  
 [9] "total_population" "med_hh_income"   
```


```r
dat &lt;- nc_wide %&gt;% ______(med_hh_income &gt; 10000) %&gt;% 
  _______(name, people_of_color = poc) %&gt;%
  ________(name)
```

fill in the blanks to get the data with poc greater 10000, with 2 columns sorted by poc in ascending order.

---
# Fill in the blanks: Type 2


```r
dat &lt;- nc_wide %&gt;% ______(poc &gt; 1000) %&gt;% 
  _______(name, poc) %&gt;%
  ________(poc)
```


```
# A tibble: 99 x 2
   name      people_of_color
   &lt;chr&gt;               &lt;dbl&gt;
 1 Graham               1129
 2 Mitchell             1143
 3 Madison              1265
 4 Yancey               1307
 5 Alleghany            1425
 6 Tyrrell              1922
 7 Ashe                 1986
 8 Camden               2047
 9 Avery                2203
10 Hyde                 2215
# … with 89 more rows
```

fill in the blanks to get the following dataset
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
